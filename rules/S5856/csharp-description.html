<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Regular expressions have their own syntax that is understood by regular expression engines. Those engines will throw an exception at runtime if they are given a regular expression that does not conform to that syntax.</p>
</div>
<div class="paragraph">
<p>To avoid syntax errors, special characters should be escaped with backslashes when they are intended to be matched literally and references to capturing groups should use the correctly spelled name or number of the group.</p>
</div>
<div class="paragraph">
<p>Negative lookahead and negative lookbehind groups cannot be combined with <code>RegexOptions.NonBacktracking</code>. Such combination would throw an exception during runtime.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public void DoSomething(string input)
{
    var regex = new Regex("[A");                // Noncompliant
    var match = Regex.Match(input, "[A");       // Noncompliant
    var matches = Regex.Matches(input, "[A");   // Noncompliant
    var replace = Regex.Replace(input, "[A", "replacement");    // Noncompliant
    var split = Regex.Split(input, "[A");       // Noncompliant
    if(Regex.IsMatch(input, "[A"))              // Noncompliant
    {
    }
    var negativeLookahead = new Regex("a(?!b)", RegexOptions.NonBacktracking);      // Noncompliant
    var negativeLookbehind = new Regex("(?&lt;!a)b", RegexOptions.NonBacktracking);    // Noncompliant
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-csharp" data-lang="csharp">public void DoSomething(string input)
{
    var regex = new Regex("[A-Z]");
    var match = Regex.Match(input, "[A-Z]");
    var matches = Regex.Matches(input, "[A-Z]");
    var replace = Regex.Replace(input, "[A-Z]", "replacement");
    var split = Regex.Split(input, "[A-Z]");
    if(Regex.IsMatch(input, "[A-Z]"))
    {
    }
    var negativeLookahead = new Regex("a(?!b)");
    var negativeLookbehind = new Regex("(?&lt;!a)b");
}</code></pre>
</div>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Fix the syntax error inside this regex</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>The error inside the regular expression</p>
</div>
</div>
</div>
</div>